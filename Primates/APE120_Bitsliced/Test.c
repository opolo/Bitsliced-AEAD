#include "Primates.h"
#include <stdio.h>
#include <string.h>
#include <immintrin.h>

#define ApeTagLength 48

//Apekey. 240bit = 30 bytes = 48 primate elements
#define ApeKey {0x00},	{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},		{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0}, \
			   {0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},		{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0}, \
			   {0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},		{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x00}, {0x0},	{0xFF}


//Nonce section. 120bit = 15 bytes = 24 primate elements
#define PrimateNonce {0xFF},{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF}, \
					 {0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0}, \
					 {0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0}


//Associated data. Just 24 primate elements for this example
#define AssData	{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF}, \
				{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0}, \
				{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF},	{0xFF}


#define Message	{0xFF}, {0xFF}, {0xFF}, {0xFF}, {0xFF}, {0xFF}, {0xFF}, {0xFF}, \
				{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0}, \
				{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0}, \
				{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0}, \
				{0xFF}, {0xFF}, {0xFF}, {0xFF}, {0xFF}, {0xFF}, {0xFF}, {0xFF}, \
				{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0}, \
				{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0}, \
				{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0},	{0x0} 

#define ADLen	24 //Should always match the size of the above in primate elements
#define MsgLen 64

void main() {

	//constant length data
	const unsigned char key[KeyLength] = { ApeKey };
	const unsigned char nonce[NonceLength] = { PrimateNonce };
	
	//variable length
	const unsigned char msg[MsgLen] = { Message };

	
	const unsigned char ad[ADLen] = { AssData };
	
	u64 adLengths = ADLen;
	
	//Return data from function. TODO: Make ciphertext support different lengths between states
	unsigned char *ciphertext;
	unsigned char tag[ApeTagLength];

	
	schwabe_primate_test();


	

	getchar();
}